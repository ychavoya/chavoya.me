export const PERSONAL_DESCRIPTION = `Yael Chavoya is a passionate Full-Stack Software Developer with a diverse set of skills and expertise and a drive to constantly improve who has developed and deployed mission-critical systems and strategic open source projects, mentored and collaborated with developers from across the globe.`;

export const CODE = `@Service class TicketUpdateHandler(ticketUpdateConsumer: TicketUpdateConsumer, private val objectMapper: ObjectMapper, private val logger: Logger) : WebSocketHandler { private val sessions: ArrayList<Pair<String, WebSocketSession>> = arrayListOf(); private val flux = Flux.create(ticketUpdateConsumer).share(); init { flux.doOnNext { logger.info("Ticket {} updated", it.ticketId) }.subscribe() }; override fun handle(session: WebSocketSession): Mono<Void> { val id = session.id; val input = session.receive().map { logger.info("Client $id requested updates for ticket \${it.payloadAsText}"); sessions.add(Pair(it.payloadAsText, session)) }.then().doFinally { logger.debug("Client $id closed connection"); sessions.removeIf { it.second.id == id } }; val output = session.send( flux.filter { update -> sessions.any { it.first == update.ticketId && it.second.id == id } }.map(objectMapper::writeValueAsString).map(session::textMessage)); return Mono.zip(input, output).then() } }`;
